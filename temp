self.response.headers['Content-Type'] = 'text/html; charset=utf-8'
		# self.response.write('<div><a href="/chooseEmployOrStudentPage/index.html">login</a></div>')				
		self.response.write('<html> <script src="https://apis.google.com/js/platform.js" async defer></script>')
		self.response.write('<meta name="google-signin-client_id" content="587253450633-tp7a8kk4k7lugngc90s0i2u6vhjsdsu5.apps.googleusercontent.com">')
		self.response.write('<div class="g-signin2" data-onsuccess="onSignIn"></div>')
		self.response.write("""<script> function onSignIn(googleUser){
			var id_token = googleUser.getAuthResponse().id_token;
			var profile = googleUser.getBasicProfile();
			console.log('idToken: ' + id_token);
			console.log('Name: ' + profile.getName());
			console.log('Image URL: ' + profile.getImageUrl());
			console.log('Email: ' + profile.getEmail()); 
			email=profile.getEmail();
			var xhr = new XMLHttpRequest();
			xhr.open('POST', '/tokenSignIn');
			xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
			//location.reload();
			xhr.onload = function() {
				
				console.log('Signed in as: ' + xhr.responseText);
				if (email.endsWith('tau.ac.il')){
					window.location="/studenthandler";
				}
				else{
					window.location="companyQueryFormPage/index.html";
				}
			};
			xhr.send('idtoken=' + id_token); }
			</script>""")
		self.response.write("""<a href="" onclick="signOut();">Sign out</a>""")
		self.response.write("""<script> function signOut() {
			var auth2 = gapi.auth2.getAuthInstance();
			auth2.signOut().then(function () {
				console.log('User signed out.');
					});
				}
			</script>""")

		#self.response.write('<div><a href="/chooseEmployOrStudentPage/index.html">login</a></div>')	

class StudentHandler(webapp2.RequestHandler):
	def get(self):
		userid = self.request.cookies.get('id')
		st = Student.query(Student.id==userid).get()
		if (st.avg == -1):
			self.response.write ("""<html><script>
				window.location="/studentInputPage";
				</script></html>""")
		else:
			self.response.write ("""<html><script>
				window.location="/StudentOffersPage";
				</script></html>""")



function onSignIn(googleUser) {
	var id_token = googleUser.getAuthResponse().id_token;
	var profile = googleUser.getBasicProfile();
	console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
	console.log('Name: ' + profile.getName());
	console.log('Image URL: ' + profile.getImageUrl());
	var email = profile.getEmail();
	console.log('Email: ' + email);
	//window.location="chooseEmployOrStudentPage/index.html";
	document.getElementById("employ_button").disabled=false;
			if (email.endsWith('tau.ac.il')){
				isStudent=true;
			}
			else{
				isStudent=false;
			}
	} 
	var xhr = new XMLHttpRequest();
	xhr.open('POST', '/tokenSignIn');
	xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
	xhr.onload = function() {
		console.log('Signed in as: ' + xhr.responseText);
	};
	xhr.send('idtoken=' + id_token);}
